# Serve JS files with the correct MIME type
AddType application/javascript .js

# Content Security Policy: allow scripts from self and allow 'unsafe-eval' (required for some Vite/React builds)
Header set Content-Security-Policy "script-src 'self' 'unsafe-eval';"

# (Optional) Allow loading fonts and styles from Google Fonts
Header always set Access-Control-Allow-Origin "*"

# (Optional) Enable gzip compression for text files
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/json
</IfModule>

# (Optional) Prevent directory listing
Options -Indexes

# Redirect all requests to index.html for SPA routing
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.html [L]

# Redirect www to non-www and force HTTPS
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ https://%1%{REQUEST_URI} [L,R=301]

# Redirect all HTTP to HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Cache static assets for 1 month
<FilesMatch "\.(js|css|png|jpg|jpeg|gif|svg|ico)$">
  Header set Cache-Control "max-age=2592000, public"
</FilesMatch> 